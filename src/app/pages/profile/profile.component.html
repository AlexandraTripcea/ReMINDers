<app-spinner *ngIf="!spinnerDissapears"></app-spinner>
<form *ngIf="spinnerDissapears" [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="container-fluid">

  <div class="content">
    <mat-card class="picture">
      <mat-card-subtitle>
        <img id="profileImg"
          [src]="profileImgUrl != '' && profileImgUrl !==undefined ? profileImgUrl : '../../../assets/img/default.png'"
          class="avatar">
      </mat-card-subtitle>
      <mat-card-content>
        <mat-card class="matcard-avatar">
          <mat-card-subtitle>
            {{this.profileForm.value.nickname}}, {{this.age}}
            <br>
            Interested in: {{this.profileForm.value.sexualPref}}
          </mat-card-subtitle>
        </mat-card>
      </mat-card-content>
      <input style="display: none" #fileInput (change)="onFileChanged($event)" type="file" accept="image/*">
      <button mat-mini-fab matTooltip="Bored of your picture photo? Choose another!" class="hover-class" style="background-color: whitesmoke" (click)="fileInput.click()">
        <mat-icon>add</mat-icon>
      </button>
    </mat-card>
  </div>

  <div class="personalinfo content pt-4">
    <mat-tab-group mat-stretch-tabs class="p-lg-5">
      <mat-tab label="Personal info">
        <div class="personalinfoint">
          <mat-form-field class="mt-3">
            <mat-label>Gender</mat-label>
            <input matInput id="gender" name="gender" formControlName="gender" type="text">
          </mat-form-field>
          <mat-form-field class="mt-3">
            <mat-label>Home</mat-label>
            <input matInput id="home" name="home" formControlName="home" type="text">
          </mat-form-field>
          <mat-form-field class="mt-3">
            <mat-label>Bio</mat-label>
            <input matInput id="bio" name="bio" formControlName="bio" type="text">
          </mat-form-field>
          <mat-form-field class="example-chip-list">
            <mat-label>Add your hobbies!</mat-label>
            <mat-chip-list #chipList aria-label="Fruit selection">
              <mat-chip *ngFor="let hobby of hobbies" [selectable]="selectable"
                        [removable]="removable" (removed)="remove(hobby)">
                {{hobby}}
                <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
              </mat-chip>
              <input placeholder="New hobby..."
                     [matChipInputFor]="chipList"
                     [matChipInputAddOnBlur]="addOnBlur"
                     (matChipInputTokenEnd)="add($event)">
            </mat-chip-list>
          </mat-form-field>
          <button mat-mini-fab matTooltip="Save" class="hover-class mt-5" style="background-color: whitesmoke" (click)="saveProfileData()" type="submit">
                <span class="material-icons">
                  save
                </span>
          </button>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>

  <div class="mindmatches content">
    <mat-tab-group mat-stretch-tabs class="p-lg-5">
      <mat-tab class="mindmatches" label="MindMatches">
        <div class="example-large-box">
          <mat-card *ngFor="let user of matchedUsers" class=" match-card m-4">
            <mat-card-header class="card-header">
              <mat-card-title>{{user.nickname}}</mat-card-title>
              <mat-card-subtitle>{{user.home}}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content class="mindmatch-font">
              {{user.bio}}
            </mat-card-content>
            <mat-card-actions>
              <button class="submit-button" mat-raised-button (click)="initializeChat(user.uid)">
                Chat
              </button>
            </mat-card-actions>
          </mat-card>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</form>

